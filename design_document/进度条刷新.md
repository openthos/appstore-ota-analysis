# 进度条刷新

- 涉及的主要类
  - package com.openthos.appstore.utils.download.DownLoadManager
  - package com.openthos.appstore.utils.download.DownLoadListener
  - package com.openthos.appstore.adapter.AppLayoutAdapter
  - package com.openthos.appstore.adapter.AppLayoutGridviewAdapter
  - package com.openthos.appstore.bean.AppLayoutGridviewInfo
  
- 主要实现
  - 在每个应用的小item项里设置监听
  ***
      mDownLoadManager.setAllTaskListener(new AppDownLoadListener());
  ***
  - 实现监听方法，并采用接口回调的方法进行数据回传
  ***
          private class AppDownLoadListener implements DownLoadListener {
            @Override
            public void onStart(SQLDownLoadInfo sqlDownLoadInfo) {
                notifyDataSetChanged();
            }
    
            @Override
            public void onProgress(SQLDownLoadInfo sqlDownLoadInfo, boolean isSupportBreakpoint) {
                for (AppLayoutGridviewInfo appInfo : (List<AppLayoutGridviewInfo>) mDatas) {
                    if ((appInfo.getId() + "").equals(sqlDownLoadInfo.getTaskID())) {
                        appInfo.setDownFileSize(sqlDownLoadInfo.getDownloadSize());
                        appInfo.setFileSize(sqlDownLoadInfo.getFileSize());
                        mUpdateProgress.onProgress(sqlDownLoadInfo);
                        break;
                    }
                }
            }
    
            @Override
            public void onStop(SQLDownLoadInfo sqlDownLoadInfo, boolean isSupportBreakpoint) {
                notifyDataSetChanged();
            }
    
            @Override
            public void onError(SQLDownLoadInfo sqlDownLoadInfo, String error) {
    
            }
    
            @Override
            public void onSuccess(SQLDownLoadInfo sqlDownLoadInfo) {
                for (AppLayoutGridviewInfo appInfo : (List<AppLayoutGridviewInfo>) mDatas) {
                    if ((appInfo.getId() + "").equals(sqlDownLoadInfo.getTaskID())) {
                        appInfo.setDownFileSize(sqlDownLoadInfo.getDownloadSize());
                        appInfo.setFileSize(sqlDownLoadInfo.getFileSize());
                        mUpdateProgress.onProgress(sqlDownLoadInfo);
                        break;
                    }
                }
            }
        }
    
        public void setUpdateProcessListener(UpdateProgress updateProgress) {
            mUpdateProgress = updateProgress;
        }
    
        public interface UpdateProgress {
            void onProgress(SQLDownLoadInfo sqlDownLoadInfo);
        }
  ***
  
  - 收到回传数据进行数据刷新,AppLayoutAdapter.java
  ***
        @Override
        public void onProgress(SQLDownLoadInfo sqlDownLoadInfo) {
            notifyDataSetChanged();
        }
  ***
  
